# Claude Codeに「他に漏れはないですか？」と10回言わせない方法

## TL;DR

- Claude Codeとの対話ログを分析したら、217箇所で同じフィードバックを繰り返していた
- `/kaizen`コマンドを作って自動改善させたら、ガイドライン4種とSkills 2種が自動生成された
- 「AIに教育される開発者」から「AIを教育する開発者」へのパラダイムシフト

---

## プロローグ: 繰り返される「他に漏れはないですか？」

Claude Codeを使い始めて1週間。ベンチマーク実装を進めていた私は、ある違和感に気づいた。

```
私: 「新しいベンチマークを実装して」
Claude: [実装]
私: 「他に漏れはないですか？」
Claude: [追加修正]
私: 「他に...」
Claude: [さらに修正]
```

この会話、何回目だろう？

conversation.logを開いて検索してみると、**同じような指摘を何十回も繰り返している**ことが判明した。

- "冗長すぎます" - 15回
- "他に漏れはないですか？" - 10回
- "すぐに実行しないで" - 3回

**これは私の時間の無駄だ。もっと言えば、Claude Codeも毎回同じ失敗をしている。**

---

## Act 1: 「AIも学習できるはず」という仮説

ふと思った。人間なら、同じミスを10回指摘されたら学習する。AIも同じはずだ。

問題は、Claude Codeは**毎回まっさらな状態で会話を始める**ということ。セッションをまたいだ記憶はない。

でも、**conversation.logには全ての対話が記録されている**。

ここに答えがあるのでは？

### 仮説: 対話ログから自動的に改善策を生成できるのでは

conversation.logを分析して：
1. 繰り返されるフィードバックパターンを抽出
2. 問題の根本原因を特定
3. Claude Codeの設定（ガイドライン、スキル）を自動生成

これができれば、Claude Codeは「過去の失敗から学ぶ」ようになる。

---

## Act 2: `/kaizen`コマンドの誕生

### 設計思想

改善（Kaizen）の精神に基づき、以下を実現するコマンドを作ることにした：

```
/kaizen → conversation.log分析 → 改善提案 → 承認 → 設定自動生成
```

### 実装のポイント

**1. 巨大ログファイルの効率的な分析**

conversation.logは115MB。そのまま読むのは非効率。

解決策: Task toolで専用エージェントを起動し、Grepで段階的に検索。

**2. フィードバックパターンの抽出**

単純な文字列マッチではなく、文脈を理解して「これは指摘だ」と判断する必要がある。

解決策: Claude自身にログを分析させ、AIの力で意味を理解。

**3. 実行可能な改善策の生成**

「冗長すぎる」というフィードバックから、どんな設定を作ればいいのか？

解決策: Claude Code公式ドキュメントを参照し、利用可能な機能（Guidelines、Skills、Hooks）を組み合わせる。

### 初実行の衝撃

```bash
/kaizen
```

数分後、出てきたレポート：

```
## フィードバック分析結果

### 主要なフィードバック
- ドキュメントの冗長性: 15回
- 実装の完全性不足: 10回
- 実行タイミングの誤判断: 3回

### 改善提案

#### 提案1: セルフレビューガイドライン
- 対象: .claude/guidelines/self-review.md
- 内容: 実装後の必須チェックリスト
- 効果: 「他に漏れはないか」の繰り返しを削減

#### 提案2: ドキュメント作成ガイドライン
- 対象: .claude/guidelines/documentation.md
- 内容: 簡潔さの原則、3ステップ作成プロセス
- 効果: 冗長なドキュメント生成を防止

#### 提案3: 実行前確認ガイドライン
...
```

**完璧だ。まさに私が欲しかった改善策が、自動で提案された。**

---

## Act 3: 改善の実施と効果測定

### 生成された成果物

`/kaizen`を実行した結果、以下が自動生成された：

**ガイドライン（4ファイル）**:
- `self-review.md`: セルフレビュー手順
- `documentation.md`: 簡潔な文章作成ルール
- `execution.md`: 実行前確認事項
- `test-failure-handling.md`: テスト失敗時の対応

**Skills（2ファイル）**:
- `code-reviewer/`: コードとドキュメントの整合性を自動チェック
- `doc-reviewer/`: マークダウンファイルの品質を自動チェック

### Before / After

**Before（改善前）**:
```
私: 新機能を実装して
Claude: [実装]
私: 冗長すぎます
Claude: [修正]
私: 他に漏れはないですか？
Claude: [追加修正]
私: まだあります...
```

**After（改善後）**:
```
私: 新機能を実装して
Claude: [self-review.mdに基づいてセルフチェック]
       [完全な実装を一度に提供]
私: 完璧です！
```

### 効果

定量的には測定しづらいが、体感として：
- **フィードバックループが激減**（2-3往復 → 1往復）
- **冗長なドキュメントが生成されなくなった**
- **「他に漏れはないか」と聞く必要がなくなった**

---

## Act 4: メタな気づき - 自己矛盾との戦い

改善を進める中で、面白い問題に遭遇した。

### 問題: セルフレビューガイドライン自体がレビューされていない

`/kaizen`が生成した`SELF_REVIEW.md`は、大文字ファイル名でkebab-case規則に違反していた。

**セルフレビューガイドラインをレビューするには、そのガイドライン自体が先に存在する必要がある。**

これは「鶏と卵」問題だ。

### 解決策: doc-reviewerスキルの追加

汎用的なドキュメントレビュースキルを作成し、`.claude/`配下のファイル自体もチェックするようにした。

```yaml
name: doc-reviewer
description: Review markdown documentation for naming conventions,
             conciseness, consistency, and completeness.
allowed-tools: Read, Grep, Glob
```

このスキルにより、ガイドライン作成時にも自動でチェックされるようになった。

### 学び: 改善ツール自体も改善が必要

`/kaizen`は一度実行して終わりではなく、継続的に実行することで効果を発揮する。

**改善サイクル**:
```
使用 → フィードバック → /kaizen実行 → 改善 → (繰り返し)
```

週次や隔週で実行することで、Claude Codeは「自分たちのプロジェクトに最適化されたAIペア」へと進化していく。

---

## Act 5: 意外な発見 - conversation.logは「AIの成績表」

この取り組みを通じて気づいたこと。

conversation.logは単なるログファイルではなく、**AIアシスタントの「成績表」**として機能する。

### 従来の考え方
- AIは賢いから任せておけば良い
- ダメなら別のAIツールに乗り換える

### 新しい考え方
- AIの弱点はログから特定できる
- 設定を調整すれば自分のスタイルに最適化できる
- 継続的改善により、AIは「育てる」ものになる

**「AIに教育される開発者」から「AIを教育する開発者」へ**

これは、AI開発ツールとの付き合い方のパラダイムシフトだと思う。

---

## エピローグ: 他のプロジェクトへの展開

jumpstarterで確立した手法は、他のプロジェクトにも適用できる。

### 適用シナリオ

1. **新規プロジェクトの立ち上げ**
   - 初期設定として`.claude/`ディレクトリをコピー
   - プロジェクト特有のガイドラインを追加

2. **既存プロジェクトの改善**
   - conversation.logを数週間蓄積
   - `/kaizen`を実行して問題点を洗い出し

3. **チーム開発**
   - チーム共通のガイドライン作成
   - ベストプラクティスの共有

### 他のAIツールへの応用

この考え方は、Claude Code以外にも応用できる：

- **Cursor**: `.cursorrules`ファイルの自動生成
- **GitHub Copilot**: コメント規約の最適化
- **カスタムLLM**: システムプロンプトの継続的改善

---

## 結論: AIツールは「育てる」時代へ

### 本プロジェクトで実証したこと

1. **対話ログからの自動改善は有効**
   - 217箇所のフィードバックから4ガイドライン + 2スキルを自動生成

2. **継続的改善サイクルの確立**
   - `/kaizen`による週次・隔週での最適化

3. **パーソナライズされたAIアシスタント**
   - 自分のスタイルに最適化されたClaude Code

### 読者へのメッセージ

もしあなたがClaude Codeを使っていて：
- 同じフィードバックを何度も繰り返している
- もっと自分のスタイルに合わせたい
- チームで一貫した開発体験を作りたい

なら、conversation.logを開いてみてください。

そこには、あなたのプロジェクトを改善するヒントが詰まっているはずです。

---

## 参考リンク

- [jumpstarterリポジトリ](https://github.com/your-org/jumpstarter) (※実際のURLに置き換え)
- [Claude Code公式ドキュメント](https://docs.claude.com/en/docs/claude-code)
- [プロジェクト履歴](./project-history.md)

---

## Appendix: `/kaizen`の始め方

### 1. conversation.logの有効化

`.claude/settings.json`にフックを設定：

```json
{
  "hooks": {
    "UserPromptSubmit": [...],
    "PostToolUse": [...]
  }
}
```

### 2. `/kaizen`コマンドの作成

`.claude/commands/kaizen.md`を作成し、分析ロジックを記述。

### 3. 定期実行

週次や隔週で`/kaizen`を実行し、改善提案を確認。

詳細は[kaizen-introduction.md](../.claude/kaizen-introduction.md)を参照。

---

**執筆日**: 2025-11-04
**プロジェクト期間**: 2025-11-01 〜 2025-11-04（4日間）
**コミット数**: 40+
**ユーザープロンプト数**: 161
**発見されたフィードバックパターン**: 217箇所
